<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.33.xsd">

    <!-- Drop all tables and clear Liquibase history to restart schema creation -->
    <changeSet id="1.0.3-drop-all-tables-and-history" author="aqua-rush">
        <comment>Drop all existing tables and clear Liquibase history for clean restart</comment>
        <sql>
            -- Drop all tables in correct order (reverse dependency order)
            DROP TABLE IF EXISTS reviews CASCADE;
            DROP TABLE IF EXISTS payment_refunds CASCADE;
            DROP TABLE IF EXISTS payments CASCADE;
            DROP TABLE IF EXISTS order_items CASCADE;
            DROP TABLE IF EXISTS orders CASCADE;
            DROP TABLE IF EXISTS reconciliation_reports CASCADE;
            DROP TABLE IF EXISTS reconciliation_discrepancies CASCADE;
            DROP TABLE IF EXISTS reconciliation_tasks CASCADE;
            DROP TABLE IF EXISTS delivery_worker_statistics CASCADE;
            DROP TABLE IF EXISTS message_history CASCADE;
            DROP TABLE IF EXISTS user_notification_settings CASCADE;
            DROP TABLE IF EXISTS delivery_addresses CASCADE;
            DROP TABLE IF EXISTS delivery_areas CASCADE;
            DROP TABLE IF EXISTS delivery_workers CASCADE;
            DROP TABLE IF EXISTS addresses CASCADE;
            DROP TABLE IF EXISTS outbox_events CASCADE;
            DROP TABLE IF EXISTS file_metadata CASCADE;
            DROP TABLE IF EXISTS users CASCADE;
            DROP TABLE IF EXISTS products CASCADE;
            DROP TABLE IF EXISTS admins CASCADE;
            DROP TABLE IF EXISTS regions CASCADE;

            -- Clear Liquibase history
            DELETE FROM DATABASECHANGELOG;
        </sql>
    </changeSet>

</databaseChangeLog>